@model CUATRG.ViewModels.ImageDetailsViewModel

@{
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script type="text/javascript">
    function radiobuttontest(albumId, imageId, processedImageId) {
        if (processedImageId > 0) {
            window.location = "details?albumId=" + albumId + "&imageId=" + imageId + "&processedImageId=" + processedImageId;
        }
        else {
            window.location = "details?albumId=" + albumId + "&imageId=" + imageId ;
        }
    }

</script>

<div class="container">
    <ol class="breadcrumb">
        <li><a href="index.html">Home</a></li>
        <li><a href="#">Albums</a></li>
        <li class="active">@Model.Image.tblAlbum.ALB_Name</li>
    </ol>
</div>
<div class="container">
    <div class="col-md-8">
        <div class="img-thumbnail">
            @{
                    
                var link = System.Configuration.ConfigurationManager.AppSettings["domain"] + "Images/default.png";

                if (Model != null)
                {
                    if (Model.ProcessedImage != null)
                    {
                        link = System.Configuration.ConfigurationManager.AppSettings["domain"] + Model.ProcessedImage.PIM_Path;
                    }
                    else
                    {
                        link = System.Configuration.ConfigurationManager.AppSettings["domain"] + Model.Image.IMG_Path;
                    }
                }
            }
            <img src="@link" style="width: 100%;"/>
        </div>
        <div class="col-md-11 well">
            <div class="col-md-4">
                <a class="btn btn-lg btn-default btn-block" href="@Url.Action("Details", "Album", new { albumId = Html.Encode(Model.Image.ALB_IDFkey), imageId = Html.Encode(Model.PreviousImage.IMG_IDPkey) })">Prev
                </a>
            </div>
            <div class="col-md-4">
                <a class="btn btn-lg btn-default btn-block" href="#">
                    @Model.Image.IMG_Name
                </a>
            </div>
            <div class="col-md-4">
                <a class="btn btn-lg btn-default btn-block" href="@Url.Action("Details", "Album", new { albumId = Html.Encode(Model.Image.ALB_IDFkey), imageId = Html.Encode(Model.NextImage.IMG_IDPkey) })">Next
                </a>
            </div>
            <div style="clear: both; height: 20px; width: 100%"></div>
            <div class="col-lg-12 well">
                <h3>Apply Filter</h3>
                <div class="input-group">
                   @if (Model.ProcessedImage == null)
                   {
                       var onClick = String.Format("radiobuttontest({0}, {1}, {2})", Model.Image.ALB_IDFkey, Model.Image.IMG_IDPkey, -1);
                       @Html.RadioButtonFor(model => model.Image, 0, new { @id = "Filter0", @onclick = onClick, @checked = "checked" })
                   }
                   else
                   {
                       var onClick = String.Format("radiobuttontest({0}, {1}, {2})", Model.Image.ALB_IDFkey, Model.Image.IMG_IDPkey, -1);
                       @Html.RadioButtonFor(model => model.Image, 0, new { @id = "Filter0", @onclick = onClick })
                   }
                    <!-- <input type="radio" value="@Model.Image.IMG_IDPkey" checked="checked" name="ProcessedImage"/>-->
                    <span style="margin-left: 5px;">Original</span>

                   @foreach (CUATRG.Models.tblProcessedImage processed in Model.Image.tblProcessedImages)
                   {
                       var onClick = String.Format("radiobuttontest({0}, {1}, {2})", Model.Image.ALB_IDFkey, Model.Image.IMG_IDPkey, processed.PIM_IDPkey);


                       if (Model.ProcessedImage != null && Model.ProcessedImage.PIM_IDPkey == processed.PIM_IDPkey)
                       {
                            @Html.RadioButtonFor(model => model.ProcessedImage, processed.PIM_IDPkey, new { @id = "Filter" + processed.PIM_IDPkey, @onclick = onClick, @checked = "checked" });
                       }
                       else
                       {
                             @Html.RadioButtonFor(model => model.ProcessedImage, processed.PIM_IDPkey, new { @id = "Filter" + processed.PIM_IDPkey, @onclick = onClick });
                       }
                       
                        <span style="margin-left: 5px;">@processed.tblFilter.FLT_Name</span>
                   }


                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4 well">
        <div class="h4">Meta Info:</div>



        <br />
        @{
            var index1 = 0;
            foreach (CUATRG.Models.tblMetaData meta in Model.Image.tblMetaDatas)
            {
                if (index1 <= 4)
                {
                        <div class="h4">@meta.tblMetaType.MTT_Description : @meta.MTD_Value</div>
                        <br />
                }

                if (index1 == 4)
                {
                    break;
                }


                index1++;
            }

            if (Model.Image.tblMetaDatas.Count > 4)
            {
                 <a class="accordion-toggle" data-toggle="collapse" href="#collapseTwo">
                    View More...
                  </a>
                 
                var index2 = 0;
                
                 <div id="collapseTwo" class="collapse">
                @{ 
                foreach (CUATRG.Models.tblMetaData meta in Model.Image.tblMetaDatas)
                {

                    if (index2 > 4)
                    {
                            
                      <div class="h4">@meta.tblMetaType.MTT_Description : @meta.MTD_Value</div>
                      <br />                         
                    }
                    index2++;
                }
                }
                 </div>
                
            }



        }
   
        <div class="well">
            <div>
             @{
                    
                 var sensordata = string.Empty;
                 var metadata = string.Empty;
                 if (Model != null)
                 {
                     if (Model.Image != null && !string.IsNullOrWhiteSpace(Model.Image.IMG_SensorDataPath))
                     {
                         sensordata = System.Configuration.ConfigurationManager.AppSettings["domain"] + Model.Image.IMG_SensorDataPath;                                           
                         <a href="@sensordata" target="_blank" class="btn btn-lg btn-primary btn-block" id="lnkSensorData" download>Download IMU Data</a>
                     }

                     if (Model.Image != null && !string.IsNullOrWhiteSpace(Model.Image.IMG_MetaDataPath))
                     {
                         metadata = System.Configuration.ConfigurationManager.AppSettings["domain"] + Model.Image.IMG_MetaDataPath;
                         <a href="@metadata" class="btn btn-lg btn-primary btn-block" target="_blank" id="lnkMetaData" download>Download Sensor Data</a>
                     }
                 }
            }
               
               
            </div>
        </div>
    </div>

</div>

